<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flowers and Flutters</title>
  <style>
    
    @font-face {
      font-family: 'MyFont';
      src: url('fonts/AyerPoster-Regular-Trial.woff2') format('woff2'),
           url('fonts/AyerPoster-Regular-Trial.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }
    @font-face {
      font-family: 'BodyFont';
      src: url('fonts/Akkurat.woff2') format('woff2'),
           url('fonts/Akkurat.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }

    html,body {
      height:100%;
      margin:0;
      padding:0;
      overflow:hidden;
      font-family: 'MyFont', serif;
      background:#fff;
    }

    .container {
      display:flex;
      justify-content:space-between;
      align-items:stretch;
      height:100%;
      width:100%;
      box-sizing:border-box;
      padding:0 2vw;
      position:relative;
    }

    /* Left & right columns */
    .side-group { display:flex; flex-direction:column; justify-content:flex-start; }
    .left-group { align-items:flex-start; }
    .right-group { align-items:flex-end; }

    .home-button, .menu-button {
      font-family:'BodyFont', sans-serif;
      font-size:13pt;
      margin-top:2rem;
      cursor:pointer;
      transition: color .36s ease;
      text-decoration: none;
      color:#333;
    }

    .flowers, .flutter {
      font-size:19vw;
      font-weight:normal;
      color:#333;
      writing-mode:vertical-rl;
      line-height:1;
      text-align:center;
      margin-top:1rem;
      transition: color .36s ease;
    }

    .flowers { transform: rotate(180deg); }

    /* Middle block centered absolutely */
    .middle {
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%,-53%);
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    .intro {
      font-family:'BodyFont', sans-serif;
      font-size:13pt;
      max-width:50%;
      text-align:center;
      margin-bottom:4rem;
      transition: color .36s ease;
    }

    .circle-image {
      width:60vmin;
      height:60vmin;
      border-radius:50%;
      overflow:hidden;
      display:flex;
      justify-content:center;
      align-items:center;
      background:#ddd;
    }
    .circle-image img { width:100%; height:100%; object-fit:cover; display:block; }

    .control-bar {
      display:flex;
      justify-content:center;
      align-items:center;
      margin-top:1.5rem;
      gap:2rem;
    }

    .pause-button {
      font-size:24pt;
      cursor:pointer;
      user-select:none;
      color:#314C1C;
      transition: color .36s ease;
    }

    /* Play triangle */
    .play-button {
      width:0;
      height:0;
      border-left:25px solid #314C1C;
      border-top:15px solid transparent;
      border-bottom:15px solid transparent;
      cursor:pointer;
      transition: border-left-color .36s ease;
    }

    .center-button { width:50px; height:50px; cursor:pointer; }
    .center-button img { width:100%; height:100%; object-fit:cover; display:block; transition: filter .36s ease; }

    /* Fullscreen overlay (starts at circle size/position then expands) */
    .fullscreen-overlay {
      position:fixed;
      /* properties set in JS to match circle start rect */
      z-index:0; /* behind other UI */
      display:flex;
      justify-content:center;
      align-items:center;
      overflow:hidden;
        background: transparent;
      transition: all .6s ease-in-out;
    }

    .fullscreen-overlay video,
    .fullscreen-overlay img {
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    /* When overlay is expanded, it's full viewport (class toggled by JS) */
    .fullscreen-overlay.expanded {
      top:50% !important;
      left:50% !important;
      width:100vw !important;
      height:100vh !important;
      border-radius:0 !important;
      transform: translate(-50%,-50%) !important;
    }

    /* WHITE UI state (applied to body when overlay fully expanded) */
    .white-ui .home-button,
    .white-ui .menu-button,
    .white-ui .pause-button,
    .white-ui .intro,
    .white-ui .flowers,
    .white-ui .flutter {
      color: #fff !important;
    }

    .white-ui .play-button { border-left-color: #fff !important; }
    .white-ui .center-button img { filter: brightness(0) invert(1) !important; }

    /* small responsiveness */
    @media (max-width:900px) {
      .intro { font-size:11pt; max-width:80%; }
      .circle-image { width:40vmin; height:40vmin; }
      .flowers, .flutter { font-size:15vw; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Left -->
    <div class="side-group left-group">
      <a href="index.html" class="home-button">HOME</a>
      <div class="flowers">FLOWERS</div>
    </div>

    <!-- Right -->
    <div class="side-group right-group">
      <div class="menu-button">MENU</div>
      <div class="flutter">FLUTTER</div>
    </div>

    <!-- Middle: intro, circle, controls -->
    <div class="middle">
      <div class="intro">
        BEAUTY SOMETIMES CAN BE MANIPULATED, OR EVEN MUST BE MANIPULATED, TO BE SEEN AS BEAUTIFUL.
      </div>

      <div class="circle-image">
        <img src="images/home-background.jpg" alt="Circular Image">
      </div>

      <div class="control-bar">
        <div class="pause-button">⏸</div>
        <div class="center-button">
          <img src="images/expand-button.png" alt="Expand">
        </div>
        <div class="play-button"></div>
      </div>
    </div>
  </div>

  <script>
    // --- element refs ---
    const playButton = document.querySelector('.play-button');
    const pauseButton = document.querySelector('.pause-button');
    const circle = document.querySelector('.circle-image');
    const expandButton = document.querySelector('.center-button');
  
    const imageSrc = 'images/home-background.jpg';
    const videoSrc = 'images/home-video.mp4';
  
    // videoEl = video inside the circle (when not expanded)
    // expandedVideo = video inside the overlay (when expanded)
    let videoEl = null;
    let expandedVideo = null;
    let overlayStartRect = null;
    let preExpandWasVideo = false; // remembers if circle had video before expand
  
    // --- PLAY ---
    playButton.addEventListener('click', () => {
      const overlay = document.querySelector('.fullscreen-overlay');
  
      if (overlay) {
        // If overlay exists, operate on the expanded area
        const ovVideo = overlay.querySelector('video');
        if (ovVideo) {
          // If a video already exists in overlay, just play it
          ovVideo.play();
          expandedVideo = ovVideo;
        } else {
          // Otherwise replace overlay content with a video
          const v = document.createElement('video');
          v.src = videoSrc;
          v.autoplay = true;
          v.loop = true;
          v.muted = true;
          v.style.width = '100%';
          v.style.height = '100%';
          v.style.objectFit = 'cover';
          v.style.borderRadius = '0';
          overlay.innerHTML = ''; // remove existing image/video node
          overlay.appendChild(v);
          expandedVideo = v;
        }
        return; // done — do not touch circle
      }
  
      // No overlay: previous behavior (create video inside circle)
      circle.innerHTML = '';
      const vid = document.createElement('video');
      vid.src = videoSrc;
      vid.autoplay = true;
      vid.loop = true;
      vid.muted = true;
      vid.style.width = '100%';
      vid.style.height = '100%';
      vid.style.objectFit = 'cover';
      vid.style.borderRadius = '50%';
      circle.appendChild(vid);
      videoEl = vid;
    });
  
    // --- PAUSE ---
    pauseButton.addEventListener('click', () => {
      const overlay = document.querySelector('.fullscreen-overlay');
  
      if (overlay) {
        // If overlay exists, pause its video (if present) but DO NOT recreate circle content
        const ovVideo = overlay.querySelector('video');
        if (ovVideo) {
          ovVideo.pause();
          expandedVideo = ovVideo;
        }
        return; // do not alter circle
      }
  
      // No overlay: previous behavior (pause & remove circle video, restore image)
      if (videoEl) {
        videoEl.pause();
        videoEl.remove();
        videoEl = null;
      }
      const img = document.createElement('img');
      img.src = imageSrc;
      img.alt = 'Circular Image';
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.objectFit = 'cover';
      circle.appendChild(img);
    });
  
    // --- EXPAND (morph) logic ---
    expandButton.addEventListener('click', () => {
      const existingOverlay = document.querySelector('.fullscreen-overlay');
  
      // if overlay exists, trigger shrink (same logic as clicking the overlay)
      if (existingOverlay) {
        shrinkOverlay(existingOverlay);
        return;
      }
  
      // capture circle rect to start animation from exact place
      const rect = circle.getBoundingClientRect();
      overlayStartRect = rect; // save for shrink
  
      // remember if circle had a video before expanding
      preExpandWasVideo = !!circle.querySelector('video') || !!videoEl;
  
      // create overlay and place it behind everything (insert as first child)
      const overlay = document.createElement('div');
      overlay.className = 'fullscreen-overlay';
      // start position = circle center-based
      overlay.style.top = `${rect.top + rect.height / 2}px`;
      overlay.style.left = `${rect.left + rect.width / 2}px`;
      overlay.style.width = `${rect.width}px`;
      overlay.style.height = `${rect.height}px`;
      overlay.style.borderRadius = '50%';
      overlay.style.transform = 'translate(-50%,-50%)';
      overlay.style.position = 'fixed';
      overlay.style.zIndex = '0';
      overlay.style.display = 'flex';
      overlay.style.justifyContent = 'center';
      overlay.style.alignItems = 'center';
      overlay.style.overflow = 'hidden';
      overlay.style.background = 'transparent';
      overlay.style.transition = 'all .6s ease-in-out';
  
      // If the circle currently had a video, create a new video inside overlay (don't clone DOM node)
      const circleVideo = circle.querySelector('video');
      if (circleVideo || videoEl) {
        const v = document.createElement('video');
        v.src = videoSrc;
        v.autoplay = true;
        v.loop = true;
        v.muted = true;
        v.style.position = 'absolute';
        v.style.top = '0';
        v.style.left = '0';
        v.style.width = '100%';
        v.style.height = '100%';
        v.style.objectFit = 'cover';
        v.style.borderRadius = '0';
        overlay.appendChild(v);
        expandedVideo = v;
      } else {
        // otherwise, create an image inside overlay
        const i = document.createElement('img');
        i.src = imageSrc;
        i.style.position = 'absolute';
        i.style.top = '0';
        i.style.left = '0';
        i.style.width = '100%';
        i.style.height = '100%';
        i.style.objectFit = 'cover';
        i.style.borderRadius = '0';
        overlay.appendChild(i);
        expandedVideo = null;
      }
  
      // insert behind all content
      document.body.insertBefore(overlay, document.body.firstChild);
  
      // remove the circle content and hide background to avoid gray flash
      const originalBg = circle.style.background;
      circle.style.background = 'transparent';
      circle.innerHTML = '';
  
      // start expand on next frame
      requestAnimationFrame(() => {
        overlay.classList.add('expanded');
        overlay.style.top = '50%';
        overlay.style.left = '50%';
        overlay.style.width = '100vw';
        overlay.style.height = '100vh';
        overlay.style.borderRadius = '0';
      });
  
      // after the overlay finishes expanding, toggle UI to white
      const onExpandEnd = (ev) => {
        if (ev.propertyName === 'width' || ev.propertyName === 'height') {
          document.body.classList.add('white-ui');
          overlay.removeEventListener('transitionend', onExpandEnd);
        }
      };
      overlay.addEventListener('transitionend', onExpandEnd);
  
      // clicking overlay will shrink it back
      overlay.addEventListener('click', () => shrinkOverlay(overlay, originalBg));
    });
  
    // shrink helper: animate overlay back and remove; restore UI colors after animation
    function shrinkOverlay(overlay, originalBg = '#ddd') {
      if (!overlay || !overlayStartRect) {
        overlay && overlay.remove();
        document.body.classList.remove('white-ui');
        return;
      }
  
      // animate back to start rect
      overlay.classList.remove('expanded');
      overlay.style.top = `${overlayStartRect.top + overlayStartRect.height / 2}px`;
      overlay.style.left = `${overlayStartRect.left + overlayStartRect.width / 2}px`;
      overlay.style.width = `${overlayStartRect.width}px`;
      overlay.style.height = `${overlayStartRect.height}px`;
      overlay.style.borderRadius = '50%';
  
      // when shrink completes, remove overlay and restore UI colors & circle content
      const onShrinkEnd = (ev) => {
        if (ev.propertyName === 'width' || ev.propertyName === 'height') {
          overlay.removeEventListener('transitionend', onShrinkEnd);
          overlay.remove();
          document.body.classList.remove('white-ui');
  
          // restore the circle background
          circle.style.background = originalBg || '#ddd';
  
          // If the expanded overlay had a video (expandedVideo exists) OR the circle had a video before expand,
          // create a circle video; otherwise restore the image.
          if (expandedVideo || preExpandWasVideo) {
            const v = document.createElement('video');
            v.src = videoSrc;
            v.autoplay = true;
            v.loop = true;
            v.muted = true;
            v.style.width = '100%';
            v.style.height = '100%';
            v.style.objectFit = 'cover';
            v.style.borderRadius = '50%';
            circle.appendChild(v);
            videoEl = v;
          } else {
            const img = document.createElement('img');
            img.src = imageSrc;
            img.alt = 'Circular Image';
            img.style.width = '100%';
            img.style.height = '100%';
            img.style.objectFit = 'cover';
            circle.appendChild(img);
          }
  
          // reset expandedVideo + preExpandWasVideo state
          expandedVideo = null;
          preExpandWasVideo = false;
        }
      };
      overlay.addEventListener('transitionend', onShrinkEnd);
    }
  </script>
  
</body>
</html>
